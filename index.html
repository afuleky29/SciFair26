<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Roboflow Classifier</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
    }
    button {
      margin-left: 6px;
    }
    img, video {
      max-width: 300px;
      margin-top: 15px;
      display: none;
      border-radius: 6px;
    }
    pre {
      background: #f2f2f2;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>

<h1>Roboflow Classifier</h1>

<!-- URL -->
<input id="imageUrl" placeholder="Image URL" size="60">
<button onclick="runURL()">Run URL</button>

<br><br>

<!-- FILE -->
<input type="file" id="filePicker" accept="image/*">
<button onclick="runFile()">Run File</button>

<br><br>

<!-- WEBCAM -->
<button onclick="startCamera()">Start Camera</button>
<button onclick="captureWebcam()">Capture</button>

<br><br>

<video id="webcam" autoplay playsinline></video>
<img id="preview">
<pre id="output"></pre>

<script>
const BACKEND_URL = "https://scifair-backend.onrender.com"; // ‚Üê YOUR BACKEND

/* ---------- URL ---------- */
async function runURL() {
  const url = document.getElementById("imageUrl").value.trim();
  if (!url) {
    alert("Enter an image URL");
    return;
  }

  document.getElementById("preview").src = url;
  document.getElementById("preview").style.display = "block";

  sendJSON({ url });
}

/* ---------- FILE ---------- */
async function runFile() {
  const file = document.getElementById("filePicker").files[0];
  if (!file) {
    alert("Choose a file first");
    return;
  }

  const formData = new FormData();
  formData.append("file", file);

  document.getElementById("preview").src = URL.createObjectURL(file);
  document.getElementById("preview").style.display = "block";

  const res = await fetch(BACKEND_URL, {
    method: "POST",
    body: formData
  });

  showResult(res);
}

/* ---------- WEBCAM ---------- */
let stream;

async function startCamera() {
  const video = document.getElementById("webcam");
  stream = await navigator.mediaDevices.getUserMedia({ video: true });
  video.srcObject = stream;
  video.style.display = "block";
}

async function captureWebcam() {
  const video = document.getElementById("webcam");
  if (!video.srcObject) {
    alert("Start camera first");
    return;
  }

  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  canvas.getContext("2d").drawImage(video, 0, 0);

  const base64 = canvas.toDataURL("image/jpeg");

  document.getElementById("preview").src = base64;
  document.getElementById("preview").style.display = "block";

  sendJSON({ base64 });
}

/* ---------- HELPERS ---------- */
async function sendJSON(payload) {
  const res = await fetch(BACKEND_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  showR
